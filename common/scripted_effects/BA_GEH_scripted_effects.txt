#消除部队混乱buff
GEH_degrade_debuff_of_troop = {
	if = {
		limit = { has_idea = GEH_army_in_chaos }
		remove_ideas = GEH_army_in_chaos
	}

	if = {
		limit = { has_idea = GEH_army_in_chaos_2 }
		swap_ideas = {
			remove_idea = GEH_army_in_chaos_2 
			add_idea = GEH_army_in_chaos
		}
	}

	if = {
		limit = { has_idea = GEH_army_in_chaos_3 }
		swap_ideas = {
			remove_idea = GEH_army_in_chaos_3 
			add_idea = GEH_army_in_chaos_2
		}
	}
}


GEH_dualHeaded_Influence_Factor_Change = {
	clamp_variable = {
		var = GEH_dualHeaded_Influence_Factor
		min = 0
		max = 1
	}

	set_variable = {
		GEH_dualHeaded_Influence_Factor_Hina_Text = GEH_dualHeaded_Influence_Factor
	}
	set_variable = {
		GEH_dualHeaded_Influence_Factor_Makoto_Text = 1
	}
	subtract_from_variable = {
		GEH_dualHeaded_Influence_Factor_Makoto_Text = GEH_dualHeaded_Influence_Factor
	}
	set_variable = {
		GEH_dualHeaded_Influence_Factor_FRAME = GEH_dualHeaded_Influence_Factor
	}
	multiply_variable = {
		GEH_dualHeaded_Influence_Factor_FRAME = 1000
	}
	
	if = {
		limit = {
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.2
				compare = less_than
			}
		}
		remove_ideas = GEH_dualHeaded_balance_makoto_2
		remove_ideas = GEH_dualHeaded_balance_makoto_1
		remove_ideas = GEH_dualHeaded_balance_normal
		remove_ideas = GEH_dualHeaded_balance_hina_1
		add_ideas = GEH_dualHeaded_balance_hina_2
	}
	if = {
		limit = {
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.2
				compare = greater_than_or_equals
			}
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.4
				compare = less_than
			}
		}
		remove_ideas = GEH_dualHeaded_balance_makoto_2
		remove_ideas = GEH_dualHeaded_balance_makoto_1
		remove_ideas = GEH_dualHeaded_balance_normal
		remove_ideas = GEH_dualHeaded_balance_hina_2
		add_ideas = GEH_dualHeaded_balance_hina_1
	}
	if = {
		limit = {
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.4
				compare = greater_than_or_equals
			}
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.6
				compare = less_than
			}
		}
		remove_ideas = GEH_dualHeaded_balance_makoto_2
		remove_ideas = GEH_dualHeaded_balance_makoto_1
		remove_ideas = GEH_dualHeaded_balance_hina_1
		remove_ideas = GEH_dualHeaded_balance_hina_2
		add_ideas = GEH_dualHeaded_balance_normal
	}
	if = {
		limit = {
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.6
				compare = greater_than_or_equals
			}
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.8
				compare = less_than
			}
		}
		remove_ideas = GEH_dualHeaded_balance_makoto_2
		remove_ideas = GEH_dualHeaded_balance_normal
		remove_ideas = GEH_dualHeaded_balance_hina_1
		remove_ideas = GEH_dualHeaded_balance_hina_2
		add_ideas = GEH_dualHeaded_balance_makoto_1
	}
	if = {
		limit = {
			check_variable = {
				var = GEH_dualHeaded_Influence_Factor
				value = 0.8
				compare = greater_than_or_equals
			}
		}
		remove_ideas = GEH_dualHeaded_balance_makoto_1
		remove_ideas = GEH_dualHeaded_balance_normal
		remove_ideas = GEH_dualHeaded_balance_hina_1
		remove_ideas = GEH_dualHeaded_balance_hina_2
		add_ideas = GEH_dualHeaded_balance_makoto_2
	}
}


#风纪委相关计算
GEH_discipline_committee_calc = {
	clamp_variable = {
		var = GEH_discipline_committee_ability
		min = 0
		max = 100
	}
	clamp_variable = {
		var = GEH_discipline_committee_repression
		min = 0
		max = 100
	}
	set_variable = { GEH_discipline_committee_research = GEH_discipline_committee_ability }
    set_variable = { GEH_discipline_committee_stability_factor = GEH_discipline_committee_ability }
    set_variable = { GEH_discipline_committee_stability_weekly = GEH_discipline_committee_ability }
    set_variable = { GEH_discipline_committee_army_org_factor = GEH_discipline_committee_ability }
    set_variable = { GEH_discipline_committee_production_factory_max = GEH_discipline_committee_repression }
    set_variable = { GEH_discipline_committee_production_factory_start = GEH_discipline_committee_repression }
	set_variable = { GEH_discipline_committee_stability_factor_temp = GEH_discipline_committee_repression }
	set_variable = { GEH_discipline_committee_stability_weekly_temp = GEH_discipline_committee_repression }
	add_to_variable = { GEH_discipline_committee_production_factory_max = -100 }
	add_to_variable = { GEH_discipline_committee_production_factory_start = -100 }
	add_to_variable = { GEH_discipline_committee_stability_factor_temp = -100 }
	add_to_variable = { GEH_discipline_committee_stability_weekly_temp = -100 }
	multiply_variable = { GEH_discipline_committee_research = -0.001}
	multiply_variable = { GEH_discipline_committee_stability_factor = 0.002 }
	multiply_variable = { GEH_discipline_committee_stability_weekly = 0.000005}
	multiply_variable = { GEH_discipline_committee_army_org_factor = 0.002 }
	multiply_variable = { GEH_discipline_committee_production_factory_max = 0.002 }
	multiply_variable = { GEH_discipline_committee_production_factory_start = 0.002 }
	multiply_variable = { GEH_discipline_committee_stability_factor_temp = 0.002 }
	multiply_variable = { GEH_discipline_committee_stability_weekly_temp = 0.000002 }
	add_to_variable = { GEH_discipline_committee_stability_factor = GEH_discipline_committee_stability_factor_temp }
	add_to_variable = { GEH_discipline_committee_stability_weekly = GEH_discipline_committee_stability_weekly_temp }
}
#温泉部相关计算
GEH_hot_spring_calc = {
	clamp_variable = {
		var = GEH_hot_spring_activity
		min = 0
		max = 100
	}
	clamp_variable = {
		var = GEH_hot_spring_destructive
		min = 0
		max = 100
	}
    set_variable = { GEH_hot_spring_production_speed_buildings = GEH_hot_spring_activity }
	set_variable = { GEH_hot_spring_industry_repair = GEH_hot_spring_activity }
	set_variable = { GEH_hot_spring_line_change_production = GEH_hot_spring_destructive }
	set_variable = { GEH_hot_spring_production_factory_efficiency = GEH_hot_spring_destructive }
	set_variable = { GEH_hot_spring_industry_repair_temp = GEH_hot_spring_destructive }
	add_to_variable = { GEH_hot_spring_line_change_production = -100 }
	add_to_variable = { GEH_hot_spring_production_factory_efficiency = -100 }
	add_to_variable = { GEH_hot_spring_industry_repair_temp = -100 }
	multiply_variable = { GEH_hot_spring_production_speed_buildings = 0.002 }
	multiply_variable = { GEH_hot_spring_industry_repair = 0.002 }
	multiply_variable = { GEH_hot_spring_line_change_production = 0.002 }
	multiply_variable = { GEH_hot_spring_production_factory_efficiency = 0.002 }
	multiply_variable = { GEH_hot_spring_industry_repair_temp = 0.005}
	add_to_variable = { GEH_hot_spring_industry_repair = GEH_hot_spring_industry_repair_temp }
}
#给食部和美食研相关计算
GEH_food_service_and_gourmet_research_calc = {
	clamp_variable = {
		var = GEH_food_service_activity
		min = 0
		max = 100
	}
	clamp_variable = {
		var = GEH_gourmet_research_activity
		min = 0
		max = 100
	}
	clamp_variable = {
		var = GEH_gourmet_research_destructive
		min = 0
		max = 100
	}
	set_variable = { GEH_food_service_supply_consumption = GEH_food_service_activity }
	set_variable = { GEH_food_serviceno_supply_grace = GEH_food_service_activity }
	set_variable = { GEH_food_service_supply_node_range = GEH_food_service_activity }
	set_variable = { GEH_food_service_consumer_goods_factor = GEH_food_service_activity }
	set_variable = { GEH_food_service_consumer_goods_factor_temp = GEH_gourmet_research_activity }
	set_variable = { GEH_gourmet_research_production_speed_industrial = GEH_gourmet_research_activity }
	set_variable = { GEH_gourmet_research_army_morale_factor = GEH_gourmet_research_activity }
	set_variable = { GEH_gourmet_research_production_speed_buildings = GEH_gourmet_research_destructive }
	set_variable = { GEH_gourmet_research_army_morale_factor_temp = GEH_gourmet_research_destructive }
	set_variable = { GEH_food_service_supply_consumption_temp = GEH_gourmet_research_destructive }
	set_variable = { GEH_food_service_supply_node_range_temp = GEH_gourmet_research_destructive }
	add_to_variable = { GEH_gourmet_research_production_speed_buildings = -100 }
	add_to_variable = { GEH_gourmet_research_army_morale_factor_temp = -100 }
	add_to_variable = { GEH_food_service_supply_consumption_temp = -100 }
	add_to_variable = { GEH_food_service_supply_node_range_temp = -100 }
    multiply_variable = { GEH_food_service_supply_consumption = -0.002 }
	multiply_variable = { GEH_food_serviceno_supply_grace = 0.6 }
	multiply_variable = { GEH_food_service_supply_node_range = 0.0015 }
	multiply_variable = { GEH_food_service_consumer_goods_factor = -0.001 }
	multiply_variable = { GEH_food_service_consumer_goods_factor_temp = 0.001 }
	multiply_variable = { GEH_gourmet_research_production_speed_industrial = 0.001 }
	multiply_variable = { GEH_gourmet_research_army_morale_factor = 0.0015 }
	multiply_variable = { GEH_gourmet_research_production_speed_buildings = 0.001 }
	multiply_variable = { GEH_gourmet_research_army_morale_factor_temp = 0.0015 }
	multiply_variable = { GEH_food_service_supply_consumption_temp = -0.0015 }
	multiply_variable = { GEH_food_service_supply_node_range_temp = 0.001 }
	add_to_variable = { GEH_food_service_supply_consumption = GEH_food_service_supply_consumption_temp }
	add_to_variable = { GEH_food_service_supply_node_range = GEH_food_service_supply_node_range_temp }
	add_to_variable = { GEH_food_service_consumer_goods_factor = GEH_food_service_consumer_goods_factor_temp }
	add_to_variable = { GEH_gourmet_research_army_morale_factor = GEH_gourmet_research_army_morale_factor_temp }
}
#每周格黑那变化
GEH_weekly_variable_change = {
	add_to_variable = { GEH_food_service_activity = 1 }
	add_to_variable = { GEH_gourmet_research_activity = 1 }
	add_to_variable = { GEH_hot_spring_activity = 1 }
	add_to_variable = { GEH_discipline_committee_ability = 1 }
	add_to_variable = { GEH_comb68_activity = 1 }
	set_variable = { GEH_food_service_efficiency_temp = GEH_food_service_activity }
	multiply_variable = { GEH_food_service_efficiency_temp = 0.002 }
	set_variable = { GEH_gourmet_research_destructive_temp = GEH_gourmet_research_activity }
	multiply_variable = { GEH_gourmet_research_destructive_temp = 0.002 }
	set_variable = { GEH_hot_spring_destructive_temp = GEH_hot_spring_activity }
	multiply_variable = { GEH_hot_spring_destructive_temp = 0.002 }
	set_variable = { GEH_discipline_committee_repression_temp = GEH_discipline_committee_ability }
	multiply_variable = { GEH_discipline_committee_repression_temp = 0.002 }
	#set_variable = { GEH_com68_destructive_temp = GEH_comb68_activity }
	#multiply_variable = { GEH_com68_destructive_temp = 0.002 }
	if = {
		limit = {
			NOT = {
                check_variable = { GEH_food_service_efficiency = 0 }
			}			
		}
		add_to_variable = { GEH_food_service_efficiency = GEH_food_service_efficiency_temp }
	}
	if = {
		limit = {
			NOT = {
                check_variable = { GEH_gourmet_research_destructive = 0 }
			}			
		}
		add_to_variable = { GEH_gourmet_research_destructive = GEH_gourmet_research_destructive_temp }
	}
	if = {
		limit = {
			NOT = {
                check_variable = { GEH_hot_spring_destructive = 0 }
			}			
		}
		add_to_variable = { GEH_hot_spring_destructive = GEH_hot_spring_destructive_temp }
	}
	if = {
		limit = {
			NOT = {
                check_variable = { GEH_discipline_committee_repression = 0 }
			}			
		}
		add_to_variable = { GEH_discipline_committee_repression = GEH_discipline_committee_repression_temp }
	}
	if = {
		limit = {
			NOT = {
                check_variable = { GEH_com68_destructive = 0 }
			}			
		}
		#add_to_variable = { GEH_com68_destructive = GEH_com68_destructive_temp }
	}	
	
}
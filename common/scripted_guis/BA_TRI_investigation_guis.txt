scripted_gui = {
    #GUI3的打开按钮
    TRI_investigation_open_window_button_gui = {
        window_name = "TRI_investigation_open_window"
        context_type = player_context
        parent_window_token = top_bar
        visible = {
            original_tag = TRI
            has_country_flag = TRI_investigate_available #在开启补课部调查的时候才可用
            is_ai = no
        }
		triggers = {
			BA_common_notice_visible = {
				NOT = {
					has_country_flag = TRI_investigation_notice
				}
                is_ai = no
			}
		}
        effects = {
            TRI_investigation_open_button_click = {
                if = {
                    limit = { has_country_flag = TRI_investigate_open }
                    clr_country_flag = TRI_investigate_open
                }
                else = {
                    set_country_flag = TRI_investigate_open
                }
            }
			BA_common_notice_click = {
				set_country_flag = TRI_investigation_notice
			}
        }
    }

    #GUI3补课部调查主页面
    noa_test_gui = {
        context_type = player_context
        window_name = "noa_test"
        visible = {
            original_tag = TRI
            has_country_flag = TRI_investigate_open
        }
        dynamic_lists = {
            TRI_investigation_portraits = {
                array = TRI_investigation_character
                index = i
                value = name
                entry_container = TRI_investigation_character_portrait_container
            }
            TRI_investigation_buttons = {
                array = TRI_investigation_decisions
                index = i
                value = decision
                entry_container = TRI_investigation_button_container
            }
        }
        effects = {
            noa_exit_click = {
                clr_country_flag = TRI_investigate_open
            }
            TRI_investigation_button_click = {
                set_variable = { exectued@var:decision = 1 }
                set_country_flag = TRI_in_inv_cooldown
                meta_effect = {
                    text = {
                        country_event = {
                            id = TRI_events.[event_id]
                            days = 7
                        }
                    }
                    event_id = "[?event@var:decision]"
                }
                if = {
                    limit = { has_country_flag = TRI_the_way_to_get_trust }
                    random_list = {
                        1 = {
                            modifier = {
                                factor = 0
                                BA_TRI_can_purge_administration = no
                            }
                            TRI_purge_administration = yes
                        }
                        1 = {
                            modifier = {
                                factor = 0
                                BA_TRI_can_purge_army = no
                            }
                            TRI_purge_army = yes
                        }
                        1 = {
                            modifier = {
                                factor = 0
                                BA_TRI_can_purge_airforce = no
                            }
                            TRI_purge_airforce = yes
                        }
                    }
                }
            }
            all_permission_button_click = {
                clr_country_flag = TRI_investigate_available
            }
        }

        triggers = {
            GFX_TRI_investigation_permission_visible = {
                check_variable = { permission@var:name = 1 }
            }
            TRI_investigation_button_visible = {
                NOT = { check_variable = { enable@var:decision = 1 } }
            }
            TRI_investigation_button_click_enabled = {
                NOT = { check_variable = { exectued@var:decision = 1 } }
                NOT = { has_country_flag = TRI_in_inv_cooldown }
            }
            all_permission_button_visible = {
                check_variable = { TRI_permitted_hoshubu_member = 4 }
                has_country_flag = TRI_investigate_available
            }
            all_permission_visible = {
                NOT = { has_country_flag = TRI_investigate_available }
                check_variable = { TRI_permitted_hoshubu_member = 4 }
            }
            

        }
        properties = {
            TRI_investigation_portrait = {
                image = "GFX_[?name.GetTokenKey]_s"
                x = TRI_investigation_character_portrait_x^i
                y = TRI_investigation_character_portrait_y^i
            }
            GFX_TRI_investigation_permission = {
                x = TRI_investigation_character_portrait_x^i
                y = TRI_investigation_character_portrait_y^i
            }
            TRI_investigation_button = {
                image = "GFX_[?decision.GetTokenKey]"
                x = TRI_investigation_decisions_x^i
                y = TRI_investigation_decisions_y^i
            }
        }
    }

}